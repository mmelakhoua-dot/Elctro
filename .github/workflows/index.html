<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Sport Market Games</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
    margin:0;
    font-family:Arial;
    background:#0b0f1a;
    color:#fff;
}
.hidden{display:none}

#login{
    height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}
#login input,button{
    width:80%;
    max-width:300px;
    margin:6px;
    padding:12px;
    border-radius:8px;
    border:none;
}
button{
    background:#1e90ff;
    color:#fff;
    font-size:16px;
}

header{
    background:#11162a;
    padding:15px;
    text-align:center;
    font-size:22px;
    font-weight:bold;
}

.product{
    background:#161c36;
    margin:10px;
    padding:10px;
    border-radius:10px;
}
.product img{
    width:100%;
    border-radius:8px;
}

.nav{
    position:fixed;
    bottom:0;
    width:100%;
    display:flex;
    background:#11162a;
}
.nav div{
    flex:1;
    text-align:center;
    padding:10px;
    font-size:18px;
    cursor:pointer;
}
.star{color:#4fc3ff}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login">
    <h2>Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <input id="name" placeholder="Ø§Ù„Ø§Ø³Ù…">
    <input id="lastname" placeholder="Ø§Ù„Ù„Ù‚Ø¨">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- APP -->
<div id="app" class="hidden">
    <header onclick="show('home')">ğŸ® Sport Market</header>

    <div id="home"></div>

    <div id="add" class="hidden">
        <input id="pname" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
        <input id="pprice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
        <input id="plocation" placeholder="Ø§Ù„Ù…ÙƒØ§Ù†">
        <input id="pdesc" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬">
        <input id="pimg" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
        <button onclick="addProduct()">OK</button>
    </div>

    <div id="search" class="hidden">
        <input id="searchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø­Ø³Ø§Ø¨" oninput="searchUser()">
        <div id="searchResults"></div>
    </div>

    <div id="profile" class="hidden"></div>
</div>

<div class="nav hidden" id="nav">
    <div onclick="show('home')">ğŸ </div>
    <div onclick="show('add')">â•</div>
    <div onclick="show('search')">ğŸ”</div>
    <div onclick="show('profile')">ğŸ‘¤</div>
</div>

<script>
let currentUser=null;

/* ===== LOGIN ===== */
function login(){
    let n=name.value.trim();
    let l=lastname.value.trim();

    if(!n||!l){
        alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨");
        return;
    }

    let users=JSON.parse(localStorage.getItem("users")||"[]");
    let user=users.find(u=>u.name===n && u.lastname===l);

    if(!user){
        user={
            name:n,
            lastname:l,
            followers:0,
            products:[]
        };
        users.push(user);
        localStorage.setItem("users",JSON.stringify(users));
    }

    currentUser=user;
    localStorage.setItem("currentUser",JSON.stringify(user));
    startApp();
}

/* ===== START APP ===== */
function startApp(){
    login.classList.add("hidden");
    app.classList.remove("hidden");
    nav.classList.remove("hidden");
    loadHome();
    loadProfile();
}

/* ===== NAV ===== */
function show(id){
    ["home","add","search","profile"].forEach(x=>{
        document.getElementById(x).classList.add("hidden");
    });
    document.getElementById(id).classList.remove("hidden");
}

/* ===== PRODUCTS ===== */
function addProduct(){
    let product={
        name:pname.value,
        price:pprice.value,
        location:plocation.value,
        desc:pdesc.value,
        img:pimg.value,
        owner:currentUser.name+" "+currentUser.lastname
    };

    let products=JSON.parse(localStorage.getItem("products")||"[]");
    products.push(product);
    localStorage.setItem("products",JSON.stringify(products));

    currentUser.products.push(product);
    updateUser();

    show("home");
    loadHome();
}

function loadHome(){
    home.innerHTML="";
    let products=JSON.parse(localStorage.getItem("products")||"[]");
    if(products.length===0){
        home.innerHTML="<p style='text-align:center'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>";
        return;
    }
    products.forEach(p=>{
        home.innerHTML+=`
        <div class="product">
            <img src="${p.img}">
            <h3>${p.name}</h3>
            <p>${p.desc}</p>
            <b>${p.price} DT</b>
            <p>Ø§Ù„Ø¨Ø§Ø¦Ø¹: ${p.owner}</p>
        </div>`;
    });
}

/* ===== SEARCH ===== */
function searchUser(){
    let val=searchInput.value.toLowerCase();
    searchResults.innerHTML="";
    let users=JSON.parse(localStorage.getItem("users")||"[]");
    users.forEach(u=>{
        if(u.name.toLowerCase().includes(val)||u.lastname.toLowerCase().includes(val)){
            let star=u.followers>=1000?"â­":"";
            searchResults.innerHTML+=`
            <div class="product">
                <b>${u.name} ${u.lastname} <span class="star">${star}</span></b>
                <p>Ù…ØªØ§Ø¨Ø¹ÙŠÙ†: ${u.followers}</p>
            </div>`;
        }
    });
}

/* ===== PROFILE ===== */
function loadProfile(){
    let star=currentUser.followers>=1000?"â­":"";
    profile.innerHTML=`
        <h2>${currentUser.name} ${currentUser.lastname} <span class="star">${star}</span></h2>
        <p>Ø§Ù„Ù…ØªØ§Ø¨Ø¹ÙŠÙ†: ${currentUser.followers}</p>
        <h3>Ù…Ù†ØªØ¬Ø§ØªÙŠ</h3>
    `;
}

/* ===== UPDATE USER ===== */
function updateUser(){
    let users=JSON.parse(localStorage.getItem("users"));
    let i=users.findIndex(u=>u.name===currentUser.name && u.lastname===currentUser.lastname);
    users[i]=currentUser;
    localStorage.setItem("users",JSON.stringify(users));
    localStorage.setItem("currentUser",JSON.stringify(currentUser));
}

/* ===== AUTO LOGIN ===== */
let saved=JSON.parse(localStorage.getItem("currentUser"));
if(saved){
    currentUser=saved;
    startApp();
}
</script>

</body>
  </html>
